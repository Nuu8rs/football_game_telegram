from .club_in_match import ClubsInMatch
from database.models.character import Character

from loader import bot, logger
from constants import FIGHT_MENU

from utils.rate_limitter import rate_limiter

import random

goal_conceded = [
    "–í–æ—Ä–æ—Ç–∞—Ä –Ω–µ–≤–¥–∞–ª–æ –≤—ñ–¥–±–∏–≤ –º'—è—á –ø—ñ—Å–ª—è —É–¥–∞—Ä—É —Å—É–ø–µ—Ä–Ω–∏–∫–∞, —ñ –Ω–∞ –¥–æ–±–∏–≤–∞–Ω–Ω—ñ –Ω–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –ø–µ—Ä—à–∏–º –æ–ø–∏–Ω–∏–≤—Å—è –±—ñ–ª—è –º'—è—á–∞, –∑–∞–±–∏–≤—à–∏ –≥–æ–ª –∑ –±–ª–∏–∑—å–∫–æ—ó –≤—ñ–¥—Å—Ç–∞–Ω—ñ.",
    "–ó–∞—Ö–∏—Å–Ω–∏–∫–∏ –ø–æ–º–∏–ª–∏–ª–∏—Å—è –≤ –ø–µ—Ä–µ–¥–∞—á—ñ, —ñ –Ω–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–ø–∏–≤ –º'—è—á, –≤–∏–π—à–æ–≤ –æ–¥–∏–Ω –Ω–∞ –æ–¥–∏–Ω –∑ –≤–æ—Ä–æ—Ç–∞—Ä–µ–º —ñ –≤—ñ–¥–ø—Ä–∞–≤–∏–≤ –º'—è—á —É —Å—ñ—Ç–∫—É –≤–æ—Ä—ñ—Ç.",
    "–ü—ñ—Å–ª—è –ø–æ–¥–∞—á—ñ –∑ –∫—É—Ç–æ–≤–æ–≥–æ –Ω–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –≤–∏–≥—Ä–∞–≤ –±–æ—Ä–æ—Ç—å–±—É —É –ø–æ–≤—ñ—Ç—Ä—ñ —ñ –≥–æ–ª–æ–≤–æ—é –ø–µ—Ä–µ–ø—Ä–∞–≤–∏–≤ –º'—è—á —É –≤–æ—Ä–æ—Ç–∞, –≤–æ—Ä–æ—Ç–∞—Ä –Ω–µ –≤—Å—Ç–∏–≥ –∑—Ä–µ–∞–≥—É–≤–∞—Ç–∏.",
    "–ü—ñ–≤–∑–∞—Ö–∏—Å–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –ø—Ä–æ–±–∏–≤ –∑–¥–∞–ª–µ–∫—É, —ñ –º'—è—á, —Ä–∏–∫–æ—à–µ—Ç–æ–º –≤—ñ–¥ –∑–∞—Ö–∏—Å–Ω–∏–∫–∞, –∑–º—ñ–Ω–∏–≤ —Ç—Ä–∞—î–∫—Ç–æ—Ä—ñ—é, –æ–±–º–∞–Ω—É–≤—à–∏ –≤–æ—Ä–æ—Ç–∞—Ä—è —Ç–∞ –∑–∞–ª–µ—Ç—ñ–≤—à–∏ —É –∫—É—Ç –≤–æ—Ä—ñ—Ç.",
    "–í–æ—Ä–æ—Ç–∞—Ä –≤—ñ–¥–±–∏–≤ –ø–µ–Ω–∞–ª—å—Ç—ñ, –∞–ª–µ —Å—É–ø–µ—Ä–Ω–∏–∫ –ø–µ—Ä—à–∏–º –æ–ø–∏–Ω–∏–≤—Å—è –±—ñ–ª—è –º'—è—á–∞ —ñ –¥–æ–±–∏–≤ –π–æ–≥–æ –≤ —Å—ñ—Ç–∫—É.",
    "–ö–æ–º–∞–Ω–¥–∞ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –ø—Ä–æ–≤–µ–ª–∞ —à–≤–∏–¥–∫—É –∫–æ–Ω—Ç—Ä–∞—Ç–∞–∫—É, —ñ –Ω–∞–ø–∞–¥–Ω–∏–∫, –æ—Ç—Ä–∏–º–∞–≤—à–∏ –ø–µ—Ä–µ–¥–∞—á—É, –æ–±—ñ–≥—Ä–∞–≤ –∑–∞—Ö–∏—Å–Ω–∏–∫—ñ–≤ —Ç–∞ –≤–æ—Ä–æ—Ç–∞—Ä—è, –∑–∞–±–∏–≤—à–∏ –º'—è—á —É –ø–æ—Ä–æ–∂–Ω—ñ –≤–æ—Ä–æ—Ç–∞.",
    "–ó–∞—Ö–∏—Å–Ω–∏–∫ –Ω–µ–≤–¥–∞–ª–æ –≤—ñ–¥–±–∏–≤ –º'—è—á –ø—ñ—Å–ª—è –ø—Ä–æ—Å—Ç—Ä—ñ–ª—É –∑ —Ñ–ª–∞–Ω–≥—É, —ñ –Ω–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –∑–∞–º–∫–Ω—É–≤ –ø–µ—Ä–µ–¥–∞—á—É —Ç–æ—á–Ω–∏–º —É–¥–∞—Ä–æ–º.",
    "–ü—ñ—Å–ª—è –ø–æ–¥–∞—á—ñ –∑ –∫—É—Ç–æ–≤–æ–≥–æ –º'—è—á –≤—ñ–¥—Å–∫–æ—á–∏–≤ –¥–æ –Ω–∞–ø–∞–¥–Ω–∏–∫–∞, —è–∫–∏–π –ø—Ä–æ–±–∏–≤ —Ç–æ—á–Ω–æ —É –¥–∞–ª—å–Ω—ñ–π –∫—É—Ç.",
    "–ù–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –æ—Ç—Ä–∏–º–∞–≤ –¥–æ–≤–≥—É –ø–µ—Ä–µ–¥–∞—á—É —ñ –≤–∏–π—à–æ–≤ —Å–∞–º –Ω–∞ —Å–∞–º –∑ –≤–æ—Ä–æ—Ç–∞—Ä–µ–º, –ª–µ–≥–∫–æ –æ–±—ñ–≥—Ä–∞–≤—à–∏ –π–æ–≥–æ.",
    "–ü—ñ–≤–∑–∞—Ö–∏—Å–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –ø—Ä–æ–±–∏–≤ —à—Ç—Ä–∞—Ñ–Ω–∏–π —É–¥–∞—Ä, —ñ –º'—è—á –∑–∞–ª–µ—Ç—ñ–≤ —Ç–æ—á–Ω–æ —É –¥–µ–≤'—è—Ç–∫—É, –≤–æ—Ä–æ—Ç–∞—Ä –Ω–µ –∑–º—ñ–≥ –¥–æ—Ç—è–≥–Ω—É—Ç–∏—Å—è.",
    "–ü—ñ—Å–ª—è —Å–µ—Ä—ñ—ó –ø–µ—Ä–µ–¥–∞—á –Ω–∞ –ø—ñ–¥—Å—Ç—É–ø–∞—Ö –¥–æ —à—Ç—Ä–∞—Ñ–Ω–æ–≥–æ –º–∞–π–¥–∞–Ω—á–∏–∫–∞ –Ω–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –ø–æ—Ç—É–∂–Ω–æ –ø—Ä–æ–±–∏–≤ –ø—ñ–¥ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω—É.",
    "–í–æ—Ä–æ—Ç–∞—Ä –Ω–µ–≤–¥–∞–ª–æ –≤–∏–π—à–æ–≤ –Ω–∞ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –ø—ñ—Å–ª—è –Ω–∞–≤—ñ—Å—É, —ñ –∑–∞—Ö–∏—Å–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –≥–æ–ª–æ–≤–æ—é –≤—ñ–¥–ø—Ä–∞–≤–∏–≤ –º'—è—á —É —Å—ñ—Ç–∫—É.",
    "–ö–æ–º–∞–Ω–¥–∞ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ —Ä–æ–∑—ñ–≥—Ä–∞–ª–∞ —à–≤–∏–¥–∫—É –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—é, —ñ –Ω–∞–ø–∞–¥–Ω–∏–∫ –∑–∞–±–∏–≤ —É –ø–æ—Ä–æ–∂–Ω—ñ –≤–æ—Ä–æ—Ç–∞ –ø—ñ—Å–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–∞—Å—É –ø–∞—Ä—Ç–Ω–µ—Ä–∞.",
    "–ó–∞—Ö–∏—Å–Ω–∏–∫ —Å–ø—Ä–æ–±—É–≤–∞–≤ –≤–∏–±–∏—Ç–∏ –º'—è—á, –∞–ª–µ –≤–ª—É—á–∏–≤ —É —Å–≤–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞, —ñ –º'—è—á –≤—ñ–¥—Å–∫–æ—á–∏–≤ –¥–æ –Ω–∞–ø–∞–¥–Ω–∏–∫–∞, —è–∫–∏–π –ª–µ–≥–∫–æ –∑–∞–±–∏–≤.",
    "–ù–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –æ–±—ñ–≥—Ä–∞–≤ –∫—ñ–ª—å–∫–æ—Ö –∑–∞—Ö–∏—Å–Ω–∏–∫—ñ–≤ —ñ –∑ –±–ª–∏–∑—å–∫–æ—ó –≤—ñ–¥—Å—Ç–∞–Ω—ñ –ø—Ä–æ–±–∏–≤ –ø–æ–≤–∑ –≤–æ—Ä–æ—Ç–∞—Ä—è.",
    "–ü—ñ—Å–ª—è —Ä–∏–∫–æ—à–µ—Ç—É –º'—è—á –æ–ø–∏–Ω–∏–≤—Å—è —É —à—Ç—Ä–∞—Ñ–Ω–æ–º—É –º–∞–π–¥–∞–Ω—á–∏–∫—É, –¥–µ –Ω–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –ø–µ—Ä—à–∏–º –≤—Å—Ç–∏–≥ –Ω–∞ —É–¥–∞—Ä.",
    "–í–æ—Ä–æ—Ç–∞—Ä –Ω–∞–º–∞–≥–∞–≤—Å—è –≤–∏–±–∏—Ç–∏ –º'—è—á, –∞–ª–µ –ø–æ–º–∏–ª–∏–≤—Å—è, —ñ –Ω–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–ø–∏–≤ –º'—è—á, –∑–∞–±–∏–≤—à–∏ —É –ø–æ—Ä–æ–∂–Ω—ñ –≤–æ—Ä–æ—Ç–∞.",
    "–ö–æ–º–∞–Ω–¥–∞ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –≤–∏–∫–æ–Ω–∞–ª–∞ —à–≤–∏–¥–∫—É –∞—Ç–∞–∫—É —á–µ—Ä–µ–∑ —Ü–µ–Ω—Ç—Ä, —ñ –Ω–∞–ø–∞–¥–Ω–∏–∫ –ø—Ä–æ–±–∏–≤ —Ç–æ—á–Ω–æ –≤ –Ω–∏–∂–Ω—ñ–π –∫—É—Ç.",
    "–ü—ñ—Å–ª—è –Ω–∞–≤—ñ—Å—É –∑ —Ñ–ª–∞–Ω–≥—É –º'—è—á –≤—ñ–¥—Å–∫–æ—á–∏–≤ –¥–æ –≥—Ä–∞–≤—Ü—è —Å—É–ø–µ—Ä–Ω–∏–∫–∞, —è–∫–∏–π –ø—Ä–æ–±–∏–≤ —É –¥–æ—Ç–∏–∫, –∑–∞–ª–∏—à–∏–≤—à–∏ –≤–æ—Ä–æ—Ç–∞—Ä—è –±–µ–∑ —à–∞–Ω—Å—ñ–≤.",
    "–ó–∞—Ö–∏—Å–Ω–∏–∫ –ø–æ—Ä—É—à–∏–≤ –ø—Ä–∞–≤–∏–ª–∞ —É —à—Ç—Ä–∞—Ñ–Ω–æ–º—É –º–∞–π–¥–∞–Ω—á–∏–∫—É, —ñ –Ω–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –≤–ø–µ–≤–Ω–µ–Ω–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞–≤ –ø–µ–Ω–∞–ª—å—Ç—ñ."
]

no_goal = [
    "–ù–∞–ø–∞–¥–Ω–∏–∫ –ø—Ä–æ—Ä–∏–≤–∞—î—Ç—å—Å—è –ø–æ —Ñ–ª–∞–Ω–≥—É, –∞–ª–µ –∑–∞—Ö–∏—Å–Ω–∏–∫ –±–ª–æ–∫—É—î –π–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä—ñ–ª, —ñ –º'—è—á –≤–∏–Ω–æ—Å—è—Ç—å –∑–∞ –º–µ–∂—ñ —à—Ç—Ä–∞—Ñ–Ω–æ–≥–æ –º–∞–π–¥–∞–Ω—á–∏–∫–∞.",
    "–û–±–∏–¥–≤—ñ –∫–æ–º–∞–Ω–¥–∏ –∞–∫—Ç–∏–≤–Ω–æ –ø—Ä–µ—Å–∏–Ω–≥—É—é—Ç—å, –º'—è—á –ø–æ—Å—Ç—ñ–π–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∑ –æ–¥–Ω—ñ—î—ó —Å—Ç–æ—Ä–æ–Ω–∏ –ø–æ–ª—è –Ω–∞ —ñ–Ω—à—É, –∞–ª–µ –∂–æ–¥–µ–Ω —ñ–∑ —É–¥–∞—Ä—ñ–≤ –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç—å –¥–æ –≤–æ—Ä—ñ—Ç.",
    "–ü—ñ—Å–ª—è —Å–µ—Ä—ñ—ó –∫—É—Ç–æ–≤–∏—Ö –∑–∞—Ö–∏—Å–Ω–∏–∫–∏ –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤ –≤–∏–±–∏–≤–∞—é—Ç—å –º'—è—á –∑ –ª—ñ–Ω—ñ—ó –≤–æ—Ä—ñ—Ç, –Ω–µ –¥–∞—é—á–∏ —Å—É–ø–µ—Ä–Ω–∏–∫—É –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –ø—Ä–æ–±–∏—Ç–∏ –ø–æ –≤–æ—Ä–æ—Ç–∞—Ö.",
    "–ü—ñ–≤–∑–∞—Ö–∏—Å–Ω–∏–∫–∏ –≤ —Ü–µ–Ω—Ç—Ä—ñ –ø–æ–ª—è –≤–µ–¥—É—Ç—å –∑–∞–ø–µ–∫–ª—É –±–æ—Ä–æ—Ç—å–±—É –∑–∞ –º'—è—á, –ø–æ—Å—Ç—ñ–π–Ω–æ –≤—ñ–¥–±–∏—Ä–∞—é—á–∏ –π–æ–≥–æ –æ–¥–∏–Ω —É –æ–¥–Ω–æ–≥–æ, –∞–ª–µ –∂–æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π –º–æ–º–µ–Ω—Ç.",
    "–ù–∞–ø–∞–¥–Ω–∏–∫ –≤–∏—Ö–æ–¥–∏—Ç—å –Ω–∞ —É–¥–∞—Ä–Ω—É –ø–æ–∑–∏—Ü—ñ—é, –∞–ª–µ –≤ –æ—Å—Ç–∞–Ω–Ω—ñ–π –º–æ–º–µ–Ω—Ç –∑–∞—Ö–∏—Å–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –ø—ñ–¥–∫–∞—Ç–æ–º –≤–∏–±–∏–≤–∞—î –º'—è—á –∑-–ø—ñ–¥ –Ω—ñ–≥.",
    "–í–æ—Ä–æ—Ç–∞—Ä –≤–∏–±—ñ–≥–∞—î –Ω–∞–∑—É—Å—Ç—Ä—ñ—á –Ω–∞–ø–∞–¥–Ω–∏–∫—É —ñ –±–ª–æ–∫—É—î –π–æ–≥–æ —É–¥–∞—Ä –≤ –æ–¥–∏–Ω –¥–æ—Ç–∏–∫, –≤—Ä—è—Ç—É–≤–∞–≤—à–∏ —Å–≤–æ—é –∫–æ–º–∞–Ω–¥—É –≤—ñ–¥ –≥–æ–ª—É.",
    "–ü—ñ—Å–ª—è —Å–µ—Ä—ñ—ó —à–≤–∏–¥–∫–∏—Ö –∞—Ç–∞–∫ –∑–∞—Ö–∏—Å–Ω–∏–∫–∏ –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω–æ –≤—ñ–¥–ø—Ä–∞—Ü—å–æ–≤—É—é—Ç—å –Ω–∞ –ø—ñ–¥–±–æ—Ä–∞—Ö, –Ω–µ –¥–æ–∑–≤–æ–ª—è—é—á–∏ —Å—É–ø–µ—Ä–Ω–∏–∫—É –∑–∞–≤–¥–∞—Ç–∏ –≤–∏—Ä—ñ—à–∞–ª—å–Ω–æ–≥–æ —É–¥–∞—Ä—É.",
    "–ù–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –≤–∏—Ö–æ–¥–∏—Ç—å –Ω–∞ —Ñ–ª–∞–Ω–≥, –æ–±—ñ–≥—Ä—É—î –æ–¥–Ω–æ–≥–æ –∑–∞—Ö–∏—Å–Ω–∏–∫–∞, –∞–ª–µ —ñ–Ω—à–∏–π –±–ª–æ–∫—É—î –π–æ–≥–æ —Å–ø—Ä–æ–±—É –ø—Ä–æ—Å—Ç—Ä—ñ–ª—É –≤ —à—Ç—Ä–∞—Ñ–Ω–∏–π –º–∞–π–¥–∞–Ω—á–∏–∫.",
    "–ü—ñ–≤–∑–∞—Ö–∏—Å–Ω–∏–∫ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –ø—Ä–æ–±–∏—Ç–∏ –∑-–∑–∞ –º–µ–∂ —à—Ç—Ä–∞—Ñ–Ω–æ–≥–æ, –∞–ª–µ –º'—è—á –≤–ª—É—á–∞—î —É —Å—Ç—ñ–Ω–∫—É –∑–∞—Ö–∏—Å–Ω–∏–∫—ñ–≤.",
    "–ù–∞–ø–∞–¥–Ω–∏–∫ –≤–∏–π—à–æ–≤ –Ω–∞ —É–¥–∞—Ä–Ω—É –ø–æ–∑–∏—Ü—ñ—é, –∞–ª–µ –∑–∞—Ö–∏—Å–Ω–∏–∫ —á—É–¥–æ–≤–æ –≤—ñ–¥–ø—Ä–∞—Ü—é–≤–∞–≤ —É –ø—ñ–¥–∫–∞—Ç—ñ, –Ω–µ –¥–∞–≤—à–∏ –π–æ–º—É –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –ø—Ä–æ–±–∏—Ç–∏.",
    "–ü—ñ—Å–ª—è —Ä–æ–∑—ñ–≥—Ä–∞—à—É –∫—É—Ç–æ–≤–æ–≥–æ –º'—è—á –≤—ñ–¥—Å–∫–∞–∫—É—î –¥–æ –∑–∞—Ö–∏—Å–Ω–∏–∫—ñ–≤, —è–∫—ñ –≤—ñ–¥—Ä–∞–∑—É –∂ –≤–∏–Ω–æ—Å—è—Ç—å –π–æ–≥–æ –ø–æ–¥–∞–ª—ñ –≤—ñ–¥ –≤–æ—Ä—ñ—Ç.",
    "–ù–∞–ø–∞–¥–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –ø—Ä–æ–±–∏–≤–∞—î –ø–æ –≤–æ—Ä–æ—Ç–∞—Ö –∑ –±–ª–∏–∑—å–∫–æ—ó –≤—ñ–¥—Å—Ç–∞–Ω—ñ, –∞–ª–µ –≤–æ—Ä–æ—Ç–∞—Ä –ø–∞—Ä–∏—Ä—É—î —É–¥–∞—Ä –Ω–æ–≥–∞–º–∏.",
    "–ü—ñ–≤–∑–∞—Ö–∏—Å–Ω–∏–∫ –ø—Ä–æ–±–∏–≤–∞—î –∑–¥–∞–ª–µ–∫—É, –∞–ª–µ –º'—è—á –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –≤–∏—â–µ –≤–æ—Ä—ñ—Ç.",
    "–ü—ñ—Å–ª—è –Ω–∞–≤—ñ—Å—É —É —à—Ç—Ä–∞—Ñ–Ω–∏–π –º–∞–π–¥–∞–Ω—á–∏–∫ –≤–æ—Ä–æ—Ç–∞—Ä –∫—É–ª–∞–∫–∞–º–∏ –≤–∏–±–∏–≤–∞—î –º'—è—á –ø–æ–¥–∞–ª—ñ –≤—ñ–¥ –≤–æ—Ä—ñ—Ç.",
    "–ö–æ–º–∞–Ω–¥–∞ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤–∏–≤–µ—Å—Ç–∏ –Ω–∞–ø–∞–¥–Ω–∏–∫–∞ –Ω–∞ —É–¥–∞—Ä–Ω—É –ø–æ–∑–∏—Ü—ñ—é, –∞–ª–µ –∑–∞—Ö–∏—Å–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –≤ –æ—Å—Ç–∞–Ω–Ω—ñ–π –º–æ–º–µ–Ω—Ç –±–ª–æ–∫—É—î –ø–µ—Ä–µ–¥–∞—á—É.",
    "–í–æ—Ä–æ—Ç–∞—Ä —É–ø–µ–≤–Ω–µ–Ω–æ –ª–æ–≤–∏—Ç—å –º'—è—á –ø—ñ—Å–ª—è –ø–æ–¥–∞—á—ñ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –∑—ñ —à—Ç—Ä–∞—Ñ–Ω–æ–≥–æ.",
    "–ü—ñ–≤–∑–∞—Ö–∏—Å–Ω–∏–∫ —Å—É–ø–µ—Ä–Ω–∏–∫–∞ –ø—Ä–æ—Ä–∏–≤–∞—î—Ç—å—Å—è –¥–æ –≤–æ—Ä—ñ—Ç, –∞–ª–µ –≤ –æ—Å—Ç–∞–Ω–Ω—é –º–∏—Ç—å –∑–∞—Ö–∏—Å–Ω–∏–∫ –≤–∏–±–∏–≤–∞—î –º'—è—á –≤ –ø—ñ–¥–∫–∞—Ç—ñ.",
    "–ü—ñ—Å–ª—è —Å–µ—Ä—ñ—ó –ø–µ—Ä–µ–¥–∞—á –Ω–∞–ø–∞–¥–Ω–∏–∫ –≤–∏—Ö–æ–¥–∏—Ç—å –Ω–∞ —É–¥–∞—Ä, –∞–ª–µ –≤–ª—É—á–∞—î –≤ –∑–∞—Ö–∏—Å–Ω–∏–∫–∞, —è–∫–∏–π –≤—Å—Ç–∏–≥ –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ –Ω–æ–≥—É –ø—ñ–¥ —É–¥–∞—Ä.",
    "–ö–æ–º–∞–Ω–¥–∏ –±–æ—Ä—é—Ç—å—Å—è –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å –º'—è—á–∞ –≤ —Ü–µ–Ω—Ç—Ä—ñ –ø–æ–ª—è, –Ω–µ –¥–æ–∑–≤–æ–ª—è—é—á–∏ –æ–¥–Ω–∞ –æ–¥–Ω—ñ–π –≤–∏–π—Ç–∏ –Ω–∞ —É–¥–∞—Ä–Ω—É –ø–æ–∑–∏—Ü—ñ—é.",
    "–ü—ñ—Å–ª—è —à–≤–∏–¥–∫–æ—ó –∞—Ç–∞–∫–∏ –∫–æ–º–∞–Ω–¥–∞ –∑–∞—Ä–æ–±–ª—è—î –∫—É—Ç–æ–≤–∏–π, –∞–ª–µ –ø–æ–¥–∞—á–∞ –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç—å –¥–æ –Ω–∞–ø–∞–¥–Ω–∏–∫—ñ–≤, —ñ –º'—è—á –≤—ñ–¥–ª—ñ—Ç–∞—î –∑–∞ –º–µ–∂—ñ –ø–æ–ª—è."
]


goal_scored = [
    "–ù–∞–ø–∞–¥–Ω–∏–∫ –æ—Ç—Ä–∏–º–∞–≤ —Ç–æ—á–Ω–∏–π –ø–∞—Å —É —à—Ç—Ä–∞—Ñ–Ω–æ–º—É –º–∞–π–¥–∞–Ω—á–∏–∫—É, –æ–±—ñ–≥—Ä–∞–≤ –≤–æ—Ä–æ—Ç–∞—Ä—è —ñ —Å–ø–æ–∫—ñ–π–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–∏–≤ –º'—è—á —É –ø–æ—Ä–æ–∂–Ω—ñ –≤–æ—Ä–æ—Ç–∞.",
    "–ü—ñ—Å–ª—è –∫—É—Ç–æ–≤–æ–≥–æ –∑–∞—Ö–∏—Å–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ –≤–∏–≥—Ä–∞–≤ –±–æ—Ä–æ—Ç—å–±—É –≤ –ø–æ–≤—ñ—Ç—Ä—ñ —Ç–∞ –≥–æ–ª–æ–≤–æ—é –ø–µ—Ä–µ–ø—Ä–∞–≤–∏–≤ –º'—è—á —É –≤–æ—Ä–æ—Ç–∞ —Å—É–ø–µ—Ä–Ω–∏–∫–∞.",
    "–ü—ñ–≤–∑–∞—Ö–∏—Å–Ω–∏–∫ –ø—Ä–æ–±–∏–≤ –∑–¥–∞–ª–µ–∫—É, —ñ –º'—è—á, –º–∏–Ω—É–≤—à–∏ —Ä—É–∫–∏ –≤–æ—Ä–æ—Ç–∞—Ä—è, –∑–∞–ª–µ—Ç—ñ–≤ –ø—Ä—è–º–æ –≤ –¥–µ–≤'—è—Ç–∫—É.",
    "–ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ–ª–∞ —à–≤–∏–¥–∫—É –∫–æ–Ω—Ç—Ä–∞—Ç–∞–∫—É, —ñ –Ω–∞–ø–∞–¥–Ω–∏–∫, –æ—Ç—Ä–∏–º–∞–≤—à–∏ –ø–∞—Å –≤—ñ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä–∞, –≤ –æ–¥–∏–Ω –¥–æ—Ç–∏–∫ –ø—Ä–æ–±–∏–≤ –ø–æ–≤–∑ –≤–æ—Ä–æ—Ç–∞—Ä—è.",
    "–ù–∞–ø–∞–¥–Ω–∏–∫ –≤—ñ–¥–≥—É–∫–Ω—É–≤—Å—è –Ω–∞ –ø—Ä–æ—Å—Ç—Ä—ñ–ª –∑ —Ñ–ª–∞–Ω–≥—É —ñ –≤ –¥–æ—Ç–∏–∫ –ø–µ—Ä–µ–ø—Ä–∞–≤–∏–≤ –º'—è—á —É –≤–æ—Ä–æ—Ç–∞.",
    "–ì—Ä–∞–≤–µ—Ü—å –∫–æ–º–∞–Ω–¥–∏ —Ä–µ–∞–ª—ñ–∑—É–≤–∞–≤ –ø–µ–Ω–∞–ª—å—Ç—ñ, —Ç–æ—á–Ω–æ –ø—Ä–æ–±–∏–≤—à–∏ —É –Ω–∏–∂–Ω—ñ–π –∫—É—Ç –≤–æ—Ä—ñ—Ç.",
    "–ü—ñ–≤–∑–∞—Ö–∏—Å–Ω–∏–∫ –æ–±—ñ–≥—Ä–∞–≤ –∫—ñ–ª—å–∫–æ—Ö —Å—É–ø–µ—Ä–Ω–∏–∫—ñ–≤ —ñ –∑-–∑–∞ –º–µ–∂ —à—Ç—Ä–∞—Ñ–Ω–æ–≥–æ –º–∞–π–¥–∞–Ω—á–∏–∫–∞ –ø—Ä–æ–±–∏–≤ —Ç–æ—á–Ω–æ –ø—ñ–¥ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω—É.",
    "–ü—ñ—Å–ª—è –¥–æ–≤–≥–æ—ó –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó –Ω–∞–ø–∞–¥–Ω–∏–∫ –æ—Ç—Ä–∏–º–∞–≤ –ø–∞—Å —É —à—Ç—Ä–∞—Ñ–Ω–æ–º—É –º–∞–π–¥–∞–Ω—á–∏–∫—É —ñ –∑ –±–ª–∏–∑—å–∫–æ—ó –≤—ñ–¥—Å—Ç–∞–Ω—ñ –ø—Ä–æ–±–∏–≤ —Ç–æ—á–Ω–æ —É –≤–æ—Ä–æ—Ç–∞.",
    "–ó–∞—Ö–∏—Å–Ω–∏–∫ –ø—ñ–¥–∫–ª—é—á–∏–≤—Å—è –¥–æ –∞—Ç–∞–∫–∏ —ñ –ø—ñ—Å–ª—è –ø–æ–¥–∞—á—ñ –∑ —Ñ–ª–∞–Ω–≥—É —Ç–æ—á–Ω–æ –ø—Ä–æ–±–∏–≤ –≥–æ–ª–æ–≤–æ—é —É –∫—É—Ç –≤–æ—Ä—ñ—Ç.",
    "–ù–∞–ø–∞–¥–Ω–∏–∫ —Ä–µ–∞–ª—ñ–∑—É–≤–∞–≤ –≤–∏—Ö—ñ–¥ –æ–¥–∏–Ω –Ω–∞ –æ–¥–∏–Ω –∑ –≤–æ—Ä–æ—Ç–∞—Ä–µ–º, –ø—Ä–æ–±–∏–≤—à–∏ —Ç–æ—á–Ω–æ —É –¥–∞–ª—å–Ω—ñ–π –∫—É—Ç.",
    "–ü—ñ–≤–∑–∞—Ö–∏—Å–Ω–∏–∫ –ø—Ä–æ–±–∏–≤ –∑–¥–∞–ª–µ–∫—É, —ñ –º'—è—á –ø—Ä–æ–ª–µ—Ç—ñ–≤ –ø–æ–≤–∑ –∫—ñ–ª—å–∫–æ—Ö –∑–∞—Ö–∏—Å–Ω–∏–∫—ñ–≤ —Ç–∞ –≤–æ—Ä–æ—Ç–∞—Ä—è, –æ–ø–∏–Ω–∏–≤—à–∏—Å—å —É –≤–æ—Ä–æ—Ç–∞—Ö.",
    "–ù–∞–ø–∞–¥–Ω–∏–∫ —Å–∫–æ—Ä–∏—Å—Ç–∞–≤—Å—è –ø–æ–º–∏–ª–∫–æ—é –∑–∞—Ö–∏—Å–Ω–∏–∫—ñ–≤, —è–∫—ñ –Ω–µ –∑–º–æ–≥–ª–∏ –≤–∏–Ω–µ—Å—Ç–∏ –º'—è—á, —ñ –ø–æ—Ç—É–∂–Ω–æ –ø—Ä–æ–±–∏–≤ –ø—ñ–¥ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω—É.",
    "–ü—ñ—Å–ª—è —Ä–æ–∑—ñ–≥—Ä–∞—à—É —à—Ç—Ä–∞—Ñ–Ω–æ–≥–æ –Ω–∞–ø–∞–¥–Ω–∏–∫ –≤ –æ–¥–∏–Ω –¥–æ—Ç–∏–∫ –≤—ñ–¥–ø—Ä–∞–≤–∏–≤ –º'—è—á —É –≤–æ—Ä–æ—Ç–∞.",
    "–ü—ñ—Å–ª—è —Å–µ—Ä—ñ—ó —Ä–∏–∫–æ—à–µ—Ç—ñ–≤ –º'—è—á –æ–ø–∏–Ω–∏–≤—Å—è —É –Ω–∞–ø–∞–¥–Ω–∏–∫–∞, —è–∫–∏–π –ø—Ä–æ–±–∏–≤ —Ç–æ—á–Ω–æ –≤ –Ω–∏–∂–Ω—ñ–π –∫—É—Ç –≤–æ—Ä—ñ—Ç.",
    "–ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ–ª–∞ —à–≤–∏–¥–∫—É –∞—Ç–∞–∫—É —á–µ—Ä–µ–∑ —Ü–µ–Ω—Ç—Ä, —ñ –Ω–∞–ø–∞–¥–Ω–∏–∫ –∑–∞–≤–µ—Ä—à–∏–≤ —ó—ó —Ç–æ—á–Ω–∏–º —É–¥–∞—Ä–æ–º —É –∫—É—Ç.",
    "–ü—ñ–≤–∑–∞—Ö–∏—Å–Ω–∏–∫ –æ—Ç—Ä–∏–º–∞–≤ –º'—è—á –Ω–∞ –ø—ñ–¥—Å—Ç—É–ø–∞—Ö –¥–æ —à—Ç—Ä–∞—Ñ–Ω–æ–≥–æ –º–∞–π–¥–∞–Ω—á–∏–∫–∞ —ñ –ø—Ä–æ–±–∏–≤ —Ç–æ—á–Ω–æ —É –∫—É—Ç –≤–æ—Ä—ñ—Ç.",
    "–ü—ñ—Å–ª—è –¥–æ–≤–≥–æ—ó –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó –ø—ñ–≤–∑–∞—Ö–∏—Å–Ω–∏–∫ –≤—ñ–¥–¥–∞–≤ –ø–∞—Å —É —à—Ç—Ä–∞—Ñ–Ω–∏–π –º–∞–π–¥–∞–Ω—á–∏–∫, —ñ –Ω–∞–ø–∞–¥–Ω–∏–∫ –≤ –æ–¥–∏–Ω –¥–æ—Ç–∏–∫ –∑–∞–±–∏–≤ –≥–æ–ª.",
    "–ü—ñ—Å–ª—è —Å–µ—Ä—ñ—ó —É–¥–∞—Ä—ñ–≤ –ø–æ –≤–æ—Ä–æ—Ç–∞—Ö –Ω–∞–ø–∞–¥–Ω–∏–∫ –Ω–∞—Ä–µ—à—Ç—ñ –∑—É–º—ñ–≤ –ø—Ä–æ–±–∏—Ç–∏ –ø–æ–≤–∑ –∑–∞—Ö–∏—Å–Ω–∏–∫—ñ–≤ —Ç–∞ –≤–æ—Ä–æ—Ç–∞—Ä—è, –∑–∞–±–∏–≤—à–∏ –≤–∏—Ä—ñ—à–∞–ª—å–Ω–∏–π –≥–æ–ª.",
    "–ö–æ–º–∞–Ω–¥–∞ –æ—Ä–≥–∞–Ω—ñ–∑—É–≤–∞–ª–∞ —à–≤–∏–¥–∫—É –∞—Ç–∞–∫—É, —ñ –Ω–∞–ø–∞–¥–Ω–∏–∫ –∑–∞–±–∏–≤ —É –ø–æ—Ä–æ–∂–Ω—ñ –≤–æ—Ä–æ—Ç–∞ –ø—ñ—Å–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–∞—Å—É –ø–∞—Ä—Ç–Ω–µ—Ä–∞.",
    "–ó–∞—Ö–∏—Å–Ω–∏–∫ –≤–∏–≥—Ä–∞–≤ –±–æ—Ä–æ—Ç—å–±—É –≤ –ø–æ–≤—ñ—Ç—Ä—ñ –ø—ñ—Å–ª—è –∫—É—Ç–æ–≤–æ–≥–æ —ñ –≥–æ–ª–æ–≤–æ—é –≤—ñ–¥–ø—Ä–∞–≤–∏–≤ –º'—è—á —Ç–æ—á–Ω–æ —É –≤–æ—Ä–æ—Ç–∞ —Å—É–ø–µ—Ä–Ω–∏–∫–∞."
]


class ClubMatchSender:
    TEMPLATE_FIGHT = """
‚öΩÔ∏è –ü–æ—á–∏–Ω–∞—î—Ç—å—Å—è –µ–ø—ñ—á–Ω–∏–π –º–∞—Ç—á –º—ñ–∂ –∫–æ–º–∞–Ω–¥–∞–º–∏ <b>{name_first_club}</b> —Ç–∞ <b>{name_second_club}</b>! 

üìä –ü–æ—Ç–æ—á–Ω–∏–π —Ä–∞—Ö—É–Ω–æ–∫: <b>{goals_first_club}</b> - <b>{goals_second_club}</b>.

üí™ –ó–∞–≥–∞–ª—å–Ω–∞ —Å–∏–ª–∞ –∫–æ–º–∞–Ω–¥:
- <b>{name_first_club}</b>: <b>{power_first_club:.2f}</b> 
- <b>{name_second_club}</b>: <b>{power_second_club:.2f}</b>

–ù–µ—Ö–∞–π –ø–µ—Ä–µ–º–æ–∂–µ –Ω–∞–π—Å–∏–ª—å–Ω—ñ—à–∏–π! üèÜ
    """

    TEMPLATE_END = """
üéâ –ú–∞—Ç—á –º—ñ–∂ –∫–æ–º–∞–Ω–¥–∞–º–∏ <b>{name_first_club}</b> —Ç–∞ <b>{name_second_club}</b> –∑–∞–≤–µ—Ä—à–µ–Ω–∞! 

üìä –ö—ñ–Ω—Ü–µ–≤–∏–π —Ä–∞—Ö—É–Ω–æ–∫: <b>{goals_first_club}</b> - <b>{goals_second_club}</b>.

{winner_section}

üèÜ –î—è–∫—É—î–º–æ –æ–±–æ–º –∫–æ–º–∞–Ω–¥–∞–º –∑–∞ —á—É–¥–æ–≤—É –≥—Ä—É! –í–∏ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä—É–≤–∞–ª–∏ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –¥—É—Ö —Å—É–ø–µ—Ä–Ω–∏—Ü—Ç–≤–∞ —Ç–∞ —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ—Å—Ç—ñ.

–î–æ –Ω–æ–≤–∏—Ö –∑—É—Å—Ç—Ä—ñ—á–µ–π –Ω–∞ —Ñ—É—Ç–±–æ–ª—å–Ω–æ–º—É –ø–æ–ª—ñ! ‚öΩÔ∏è
    """
    
    TEMPLATE_NOT_CHARACTERS = """
–ù–∞ –∂–∞–ª—å, –Ω—ñ—Ö—Ç–æ –∑ —É—á–∞—Å–Ω–∏–∫—ñ–≤ –Ω–µ –∑'—è–≤–∏–≤—Å—è –Ω–∞ —Ü–µ–π –º–∞—Ç—á. üòî
    """

    TEMPLATE_SEND_REWARD_CHARACTER = """
üéâ –ó–∞ —Ü–µ–π –º–∞—Ç—á –º—ñ–∂ –∫–æ–º–∞–Ω–¥–∞–º–∏ '{name_first_club}' —ñ '{name_second_club}' –≤–∏ –æ—Ç—Ä–∏–º–∞–ª–∏:
‚ú® {exp_points} –¥–æ—Å–≤—ñ–¥—É
üí∞ {coins} –º–æ–Ω–µ—Ç
    """


    def __init__(self, clubs_in_match: ClubsInMatch):
        self.clubs_in_match = clubs_in_match


    def _format_message(self, template: str, extra_context: dict = None) -> str:
        context = {
            'name_first_club': self.clubs_in_match.first_club.name_club,
            'name_second_club': self.clubs_in_match.second_club.name_club,
            'goals_first_club': self.clubs_in_match.goals_first_club,
            'goals_second_club': self.clubs_in_match.goals_second_club,
            'power_first_club': self.clubs_in_match.first_club_power ,
            'power_second_club': self.clubs_in_match.second_club_power,
        }
        if extra_context:
            context.update(extra_context)
        return template.format(**context)

    def get_text_fight(self) -> str:
        return self._format_message(self.TEMPLATE_FIGHT)
    
    def get_text_send_reward(self, exp_points: int, coins:int) -> str:
        return self._format_message(template=self.TEMPLATE_SEND_REWARD_CHARACTER, 
                                    extra_context={"exp_points":exp_points,"coins":coins})

    def get_text_winners(self) -> str:
        if self.clubs_in_match.goals_first_club == self.clubs_in_match.goals_second_club:
            winner_section = "üéâ –ú–∞—Ç—á –∑–∞–≤–µ—Ä—à–∏–≤—Å—è –≤–Ω—ñ—á–∏—é!"
        else:
            winner, loser = self._determine_winner_loser()
            winner_section = f"""
ü•á –ü–µ—Ä–µ–º–æ–∂–µ—Ü—å: <b>{winner['club_name']}</b> –∑ —Ä–∞—Ö—É–Ω–∫–æ–º <b>{winner['goals']}</b>! 
ü•à –î—Ä—É–≥–µ –º—ñ—Å—Ü–µ: <b>{loser['club_name']}</b> –∑ —Ä–∞—Ö—É–Ω–∫–æ–º <b>{loser['goals']}</b>.
            """
        return self._format_message(self.TEMPLATE_END, {'winner_section': winner_section})


    def get_text_goal_evenet(self, goal_event: str) -> str:
        current_score = (
            f"üìä –ü–æ—Ç–æ—á–Ω–∏–π —Ä–∞—Ö—É–Ω–æ–∫: "
            f"<b>{self.clubs_in_match.first_club.name_club}</b> {self.clubs_in_match.goals_first_club} - "
            f"{self.clubs_in_match.goals_second_club} <b>{self.clubs_in_match.second_club.name_club}</b>"
        )

        if goal_event == "goal":
            message = random.choice(goal_scored)
            current_score += f"\n\nüí™üèª –ì–æ–ª –∑–∞–±–∏–≤: {self.clubs_in_match.how_to_increment_goal.name}"
            
        elif goal_event == "no_goal":
            message = random.choice(no_goal)
        else:
            message = random.choice(goal_conceded)
            current_score += f"\n\nüí™üèª –ì–æ–ª –∑–∞–±–∏–≤: {self.clubs_in_match.how_to_increment_goal.name}"

        return f"{message}\n\n{current_score}"


    def _determine_winner_loser(self) -> tuple[dict, dict]:
        if self.clubs_in_match.goals_first_club > self.clubs_in_match.goals_second_club:
            return (
                {'club_name': self.clubs_in_match.first_club.name_club, 'goals': self.clubs_in_match.goals_first_club},
                {'club_name': self.clubs_in_match.second_club.name_club, 'goals': self.clubs_in_match.goals_second_club}
            )
        else:
            return (
                {'club_name': self.clubs_in_match.second_club.name_club, 'goals': self.clubs_in_match.goals_second_club},
                {'club_name': self.clubs_in_match.first_club.name_club, 'goals': self.clubs_in_match.goals_first_club}
            )

    async def send_messages_to_users(self, text: str, characters: list[Character], send_photo: bool = True) -> dict[int, int]:
        for character in characters:
            if character.is_bot:
                continue
            await self._send_message_to_character(character, text, send_photo)

    @rate_limiter
    async def _send_message_to_character(self, character: Character, text: str, send_photo: bool = True) -> None:
        if not character.is_bot:
            try:
                if send_photo:
                    await bot.send_photo(
                        chat_id=character.characters_user_id,
                        photo=FIGHT_MENU,
                        caption=text
                    )
                else:
                    await bot.send_message(
                        chat_id=character.characters_user_id,
                        text=text
                    )
            except Exception as E:
                logger.error(f"Failed to send message to {character.owner.user_name}\nError: {E}")

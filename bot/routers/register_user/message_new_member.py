import asyncio
from aiogram import Bot

from loader import bot
from logging_config import logger

from .constans import ADITIONAL_INFO_PHOTO

TEXT_TEMPLATE_NEW_USER = """
<b>–û—Å–Ω–æ–≤–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –¥–ª—è –Ω–æ–≤–∞—á–∫—ñ–≤ ‚öΩÔ∏è</b>

<b>‚ùì–Ø–∫ –≥—Ä–∞—Ç–∏?</b>
–û—Å–Ω–æ–≤–Ω–µ ‚Äî —Ü–µ <b>—Ç—Ä–µ–Ω—É–≤–∞—Ç–∏—Å—è –≤ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–Ω–æ–º—É –∑–∞–ª—ñ</b> —Ç–∞ <b>–≥—Ä–∞—Ç–∏ –º–∞—Ç—á—ñ –∑ –∫–æ–º–∞–Ω–¥–æ—é</b>. 
–ß–∏–º —á–∞—Å—Ç—ñ—à–µ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è ‚Äî —Ç–∏–º –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–µ –∑—Ä–æ—Å—Ç–∞—î —Å–∏–ª–∞ –≥—Ä–∞–≤—Ü—è üí™
–¢–∞–∫–æ–∂ —Ç—Ä–µ–Ω—É–≤–∞—Ç–∏—Å—è –º–æ–∂–Ω–∞ –∑ <b>—Ç—Ä–µ–Ω–µ—Ä–æ–º</b> üßë‚Äçüè´ ‚Äî –∑–∞ <b>–∫–ª—é—á—ñ –¥–æ —Ç—Ä–µ–Ω—É–≤–∞–Ω—å</b> üîë

<b>‚ùì–Ø–∫ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å–≤—ñ–¥ —Ç–∞ –º–æ–Ω–µ—Ç–∏?</b>
üìö <b>–ù–∞–≤—á–∞–ª—å–Ω–∏–π —Ü–µ–Ω—Ç—Ä</b> ‚Äî –∫–æ–∂–Ω—ñ <b>12 –≥–æ–¥–∏–Ω</b>
üèÜ <b>–ü–µ—Ä–µ–º–æ–≥–∏ —É –º–∞—Ç—á–∞—Ö</b>
üí• <b>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è</b> –∑ —Ç—Ä–µ–Ω–µ—Ä–æ–º (—Ç—Ä–∏ —Ä–∞–∑–∏ –Ω–∞ –¥–µ–Ω—å)

<b>‚ùì–Ø–∫ —Ç–∞ –∫–æ–ª–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç—å –º–∞—Ç—á—ñ?</b>
üïò <b>–©–æ–¥–Ω—è –æ 21:00</b>  
üìÖ <b>–°–µ–∑–æ–Ω —Å—Ç–∞—Ä—Ç—É—î 1 —á–∏—Å–ª–∞ –∫–æ–∂–Ω–æ–≥–æ –º—ñ—Å—è—Ü—è</b>  
‚öôÔ∏è –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤–∏–∑–Ω–∞—á–∞—î –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∞ –º–æ–¥–µ–ª—å: —á–∏–º –±—ñ–ª—å—à–∞ —Å–∏–ª–∞ –∫–æ–º–∞–Ω–¥–∏ ‚Äî —Ç–∏–º –≤–∏—â—ñ —à–∞–Ω—Å–∏ –Ω–∞ –ø–µ—Ä–µ–º–æ–≥—É

üèÜ <b>–¢–æ–ø-20 –∫–æ–º–∞–Ω–¥ –ø–æ —Å–∏–ª—ñ</b> ‚Äî <i>–ö—É–±–æ–∫ –£–∫—Ä–∞—ó–Ω–∏</i>  
üåç <b>–¢–æ–ø-24 –∫–æ–º–∞–Ω–¥ –†–µ–π—Ç–∏–Ω–≥—É</b> ‚Äî <i>–Ñ–≤—Ä–æ–∫—É–±–∫–æ–≤—ñ –º–∞—Ç—á—ñ</i>

<b>üë• –ö–æ–º–∞–Ω–¥–∏‚ÄºÔ∏è</b>
–î—É–∂–µ –≤–∞–∂–ª–∏–≤–æ ‚Äî –≥—Ä–∞—Ç–∏ –≤ <b>–∫–æ–º–∞–Ω–¥—ñ</b>!  
üîπ –°—Ç–≤–æ—Ä–∏ —Å–≤–æ—é  
üîπ –ó–∞–ø—Ä–æ—Å–∏ –¥—Ä—É–∑—ñ–≤  
üîπ –ê–±–æ –ø—Ä–∏—î–¥–Ω—É–π—Å—è –¥–æ —ñ—Å–Ω—É—é—á–æ—ó  

<b>‚ö†Ô∏è –ú–∞—Ç—á—ñ –º–æ–∂–ª–∏–≤—ñ –ª–∏—à–µ —è–∫—â–æ —Ç–∏ –≤ –∫–æ–º–∞–Ω–¥—ñ!</b>

<b>üí¨ –î–æ–ª—É—á–∞–π—Å—è –¥–æ –Ω–∞—à–æ–≥–æ —á–∞—Ç—É</b> ‚Äî –º–∏ –¥–æ–ø–æ–º–æ–∂–µ–º–æ –∑ –±—É–¥—å-—è–∫–∏–º–∏ –ø–∏—Ç–∞–Ω–Ω—è–º–∏!
üëâ <a href="https://t.me/tgfootballchat">https://t.me/tgfootballchat</a>
"""

class SendMessageNewMember:
    _bot: Bot = bot
    
    def __init__(self, user_id: int):
        self.user_id = user_id
        
    @classmethod
    async def send_message(cls, user_id: int):
        instance = cls(user_id)
        asyncio.create_task(instance._await())
    
    async def _await(self):
        await asyncio.sleep(3*60*60)
        await self._send_message()
        
    async def _send_message(self):
        try:
            await self._bot.send_photo(
                photo=ADITIONAL_INFO_PHOTO,
                chat_id=self.user_id,
                caption=TEXT_TEMPLATE_NEW_USER,
                disable_notification=True
            )
        except Exception as e:
            logger.error(f"Error sending message to {self.user_id}: {e}")
        